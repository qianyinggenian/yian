"use strict";(self["webpackChunkyian"]=self["webpackChunkyian"]||[]).push([[211],{57992:function(e,t,s){s.r(t),s.d(t,{default:function(){return C}});var a=function(){var e=this,t=e._self._c;return t("layout",{attrs:{"is-show-left":!1}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{slot:"right","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(10, 38, 63,0.6)","element-loading-custom-class":"loading-icon"},slot:"right"},[t("proxy-table",{ref:"proxyTable",attrs:{operations:e.operations,columns:e.columns,operationWidth:"200px","table-btns":e.tableBtns,"table-data":e.tableData,"diy-has-check-box":e.diyHasCheckBox},on:{add:e.handleAdd,edit:e.handleEdit,show:e.handleShow,remove:e.handleRemove,delete:e.handleDelete,select:e.handleSelect}}),e.isShowAddEdit?t("add-edit",{ref:"addEdit",on:{close:e.closeFn}}):e._e()],1)])},r=[],o=s(46297),l=function(){var e=this,t=e._self._c;return t("proxy-dialog",{ref:"dialog",attrs:{visible:e.isShowDialog,"is-show-footer":"show"!==e.type},on:{"update:visible":function(t){e.isShowDialog=t},close:e.handleClose}},[t("div",{staticClass:"dialog-form"},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,size:"small","label-width":"auto"}},[t("el-row",{attrs:{type:"flex",justify:"space-around",gutter:50}},[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"姓名",prop:"name",title:e.ruleForm.name}},[t("el-input",{attrs:{disabled:e.disabled,clearable:"",placeholder:"请输入"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1)],1),t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"账号",prop:"account",title:e.ruleForm.account}},[t("el-input",{attrs:{disabled:e.disabled,clearable:"",placeholder:"请输入"},model:{value:e.ruleForm.account,callback:function(t){e.$set(e.ruleForm,"account",t)},expression:"ruleForm.account"}})],1)],1)],1),t("el-row",{attrs:{type:"flex",justify:"space-around",gutter:50}},[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{autocomplete:"new-password",type:"password","show-password":"",disabled:e.disabled,clearable:"",placeholder:"请输入"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1)],1),t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[t("el-input",{attrs:{type:"password",autocomplete:"new-password",disabled:e.disabled,clearable:"",placeholder:"请输入","show-password":""},model:{value:e.ruleForm.confirmPassword,callback:function(t){e.$set(e.ruleForm,"confirmPassword",t)},expression:"ruleForm.confirmPassword"}})],1)],1)],1),t("el-row",{attrs:{type:"flex",justify:"space-around",gutter:50}},[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"状态",prop:"status"}},[t("proxySelect",{attrs:{disabled:e.disabled,options:e.accountStatusOptions,clearable:""},model:{value:e.ruleForm.status,callback:function(t){e.$set(e.ruleForm,"status",t)},expression:"ruleForm.status"}})],1)],1),t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"邮箱",prop:"email",title:e.ruleForm.email}},[t("el-input",{attrs:{disabled:e.disabled,clearable:"",placeholder:"请输入"},model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1)],1)],1),t("el-row",{attrs:{type:"flex",justify:"space-around",gutter:50}},[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"是否超管",prop:"isAdmin"}},[t("proxySelect",{attrs:{disabled:e.disabled,options:e.yesOrNo,clearable:""},model:{value:e.ruleForm.isAdmin,callback:function(t){e.$set(e.ruleForm,"isAdmin",t)},expression:"ruleForm.isAdmin"}})],1)],1),t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"类型",prop:"type"}},[t("proxySelect",{attrs:{disabled:e.disabled,options:e.typeOptions,clearable:""},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}})],1)],1)],1)],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleSave}},[e._v("保存")])],1)])},i=[],n=s(27484),d=s.n(n),c=s(15623),u=s.n(c),m=s(20629),p=s(18965),h=s.n(p),g=s(90214),f=s(38039),b=s(96851),y=s(95913);const w=u().Random;var x={name:"add-edit",components:{proxyDialog:f.Z,proxySelect:b.Z},data(){return{encryptionKey:g.L1,decryptKey:g.vn,type:"add",ruleForm:{isAdmin:""},rules:{name:[{required:!0,message:"请输入",trigger:"blur"}],account:[{required:!0,message:"请输入",trigger:"blur"}],password:[{required:!0,message:"请输入",trigger:"blur"}],confirmPassword:[{required:!0,message:"请输入",trigger:"blur"}],status:[{required:!0,message:"请选择",trigger:"change"}],isAdmin:[{required:!0,message:"请选择",trigger:"change"}],type:[{required:!0,message:"请选择",trigger:"change"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}]},typeOptions:y.mS,accountStatusOptions:y.lO,yesOrNo:y.nt,disabled:!1,isShowDialog:!1}},props:{},watch:{},computed:{...(0,m.Se)(["personalMsg"])},mounted(){},methods:{encrypt(e){const t=new(h());return t.setPublicKey(this.encryptionKey),t.encrypt(e)},decrypt(e){const t=new(h());return t.setPrivateKey(this.decryptKey),t.decrypt(e)},async getInfo(e){const{type:t,id:s}=e;if(console.log("Random.guid()",w.guid()),this.isShowDialog=!0,this.type=t,this.disabled="show"===t,"add"===t)return this.$set(this.ruleForm,"isAdmin","0"),this.$set(this.ruleForm,"status","启用"),!1;const a=await o.Z.userDetail({id:s}),{code:r,data:l,msg:i}=a;if(200===r){this.ruleForm=l;const{confirmPassword:e,password:t}=this.ruleForm;this.ruleForm.password=t?this.decrypt(t):t,this.ruleForm.confirmPassword=e?this.decrypt(e):e}else this.$message.error(i)},handleClose(){this.isShowDialog=!1,this.$emit("close")},handleSave(){try{this.$refs.ruleForm.validate((async e=>{if(e){let e={};const{confirmPassword:t,password:s}=this.ruleForm;e="add"===this.type?{...this.ruleForm,id:w.guid(),creatDate:d()().format("YYYY-MM-DD HH:mm:ss"),creator:this.personalMsg.username,password:this.encrypt(s),confirmPassword:this.encrypt(t)}:{...this.ruleForm,password:this.encrypt(s),confirmPassword:this.encrypt(t)};const a=await o.Z["add"===this.type?"userSave":"userUpdate"](e),{code:r,msg:l}=a;200===r?(this.$message.success(l),this.$emit("close",!0)):this.$message.error(l)}}))}catch(e){console.log(e)}}}},v=x,F=s(1001),S=(0,F.Z)(v,l,i,!1,null,"650313ce",null),$=S.exports,D=s(37809),k=s(16879),A={name:"index",components:{addEdit:$,proxyTable:D.Z},data(){return{loading:!1,isShowAddEdit:!1,tableData:[],selections:[],tableBtns:[{label:"查看",value:"show"},{label:"编辑",value:"edit"},{label:"删除",value:"delete"}],operations:[{value:"add",label:"新增"},{value:"remove",label:"删除"}],columns:[{prop:"name",label:"姓名"},{prop:"account",label:"账号"},{prop:"type",label:"类型"},{prop:"email",label:"邮箱"},{prop:"status",label:"状态"},{prop:"creator",label:"创建者"},{prop:"creatDate",label:"创建时间"}]}},mounted(){this.$nextTick((()=>{this.getList()}))},methods:{async getList(){this.loading=!0;const e=await o.Z.userList(),{code:t,data:s,msg:a}=e;200===t?(this.tableData=s.list||[],this.tableData.sort(k.o4)):this.$message.error(a),this.loading=!1},handleAdd(){this.isShowAddEdit=!0,this.$nextTick((()=>{this.$refs.addEdit.getInfo({type:"add"})}))},handleEdit(e){this.handleDetail({type:"edit",id:e.id})},handleDetail(e){this.isShowAddEdit=!0,this.$nextTick((()=>{this.$refs.addEdit.getInfo(e)}))},handleShow(e){this.handleDetail({type:"show",id:e.id})},handleDelete(e){if("1"===e.isAdmin)return this.$message.info("该条数据不可删除"),!1;this.$confirm("确定删除该条数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{this.loading=!0;const t=await o.Z.userDelete({id:e.id});200===t.code?(this.$message.success(t.msg),this.$nextTick((()=>{this.getList()}))):this.$message.error(t.msg),this.loading=!1})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},handleSelect(e){this.selections=e},diyHasCheckBox(e,t){return"1"!==e.isAdmin},handleRemove(){const e=this.selections.map((e=>e.id));if(0===e.length)return this.$message.error("请选择数据！"),!1;this.$confirm("确定删除所选数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{this.loading=!0;const t=await o.Z.userBatchDelete({ids:e});200===t.code?(this.$message.success(t.msg),this.$nextTick((()=>{this.getList()}))):this.$message.error(t.msg),this.loading=!1})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},closeFn(e){this.isShowAddEdit=!1,e&&this.getList()}}},E=A,T=(0,F.Z)(E,a,r,!1,null,"4a1a3a77",null),C=T.exports},95913:function(e,t,s){s.d(t,{lO:function(){return r},mS:function(){return a},nt:function(){return o}});const a=[{value:"超管",label:"超管",id:"EeFDC299-f42b-8cc7-1bfB-dF189C655661"},{value:"用户",label:"用户",id:"C82CB616-1173-2eA6-4dD1-b92EfF2406eb"},{value:"访客",label:"访客",id:"E59Dcfb1-0d6b-11C2-F884-6FC26e9815C3"}],r=[{value:"启用",label:"启用"},{value:"禁用",label:"禁用"}],o=[{value:"1",label:"是"},{value:"0",label:"否"}]},16879:function(e,t,s){s.d(t,{jA:function(){return r},o4:function(){return a}});s(70560),s(98858),s(61318),s(33228);function a(e,t,s="creatDate"){return Date.parse(t[s])-Date.parse(e[s])}function r(){let e=(new Date).getTime();const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const s=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?s:3&s|8).toString(16)}));return t}},50926:function(e,t,s){var a=s(23043),r=s(69985),o=s(6648),l=s(44201),i=l("toStringTag"),n=Object,d="Arguments"===o(function(){return arguments}()),c=function(e,t){try{return e[t]}catch(s){}};e.exports=a?o:function(e){var t,s,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(s=c(t=n(e),i))?s:d?o(t):"Object"===(a=o(t))&&r(t.callee)?"Arguments":a}},62148:function(e,t,s){var a=s(98702),r=s(72560);e.exports=function(e,t,s){return s.get&&a(s.get,t,{getter:!0}),s.set&&a(s.set,t,{setter:!0}),r.f(e,t,s)}},23043:function(e,t,s){var a=s(44201),r=a("toStringTag"),o={};o[r]="z",e.exports="[object z]"===String(o)},34327:function(e,t,s){var a=s(50926),r=String;e.exports=function(e){if("Symbol"===a(e))throw new TypeError("Cannot convert a Symbol value to a string");return r(e)}},21500:function(e){var t=TypeError;e.exports=function(e,s){if(e<s)throw new t("Not enough arguments");return e}},98858:function(e,t,s){var a=s(11880),r=s(68844),o=s(34327),l=s(21500),i=URLSearchParams,n=i.prototype,d=r(n.append),c=r(n["delete"]),u=r(n.forEach),m=r([].push),p=new i("a=1&a=2&b=3");p["delete"]("a",1),p["delete"]("b",void 0),p+""!=="a=2"&&a(n,"delete",(function(e){var t=arguments.length,s=t<2?void 0:arguments[1];if(t&&void 0===s)return c(this,e);var a=[];u(this,(function(e,t){m(a,{key:t,value:e})})),l(t,1);var r,i=o(e),n=o(s),p=0,h=0,g=!1,f=a.length;while(p<f)r=a[p++],g||r.key===i?(g=!0,c(this,r.key)):h++;while(h<f)r=a[h++],r.key===i&&r.value===n||d(this,r.key,r.value)}),{enumerable:!0,unsafe:!0})},61318:function(e,t,s){var a=s(11880),r=s(68844),o=s(34327),l=s(21500),i=URLSearchParams,n=i.prototype,d=r(n.getAll),c=r(n.has),u=new i("a=1");!u.has("a",2)&&u.has("a",void 0)||a(n,"has",(function(e){var t=arguments.length,s=t<2?void 0:arguments[1];if(t&&void 0===s)return c(this,e);var a=d(this,e);l(t,1);var r=o(s),i=0;while(i<a.length)if(a[i++]===r)return!0;return!1}),{enumerable:!0,unsafe:!0})},33228:function(e,t,s){var a=s(67697),r=s(68844),o=s(62148),l=URLSearchParams.prototype,i=r(l.forEach);a&&!("size"in l)&&o(l,"size",{get:function(){var e=0;return i(this,(function(){e++})),e},configurable:!0,enumerable:!0})}}]);
//# sourceMappingURL=211.a28ca667.js.map