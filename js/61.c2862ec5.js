"use strict";(self["webpackChunkyian"]=self["webpackChunkyian"]||[]).push([[61],{13061:function(t,e,l){l.r(e),l.d(e,{default:function(){return c}});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("el-select",{attrs:{placeholder:"请选择"},on:{change:t.handleClear},model:{value:t.typeValue,callback:function(e){t.typeValue=e},expression:"typeValue"}},t._l(t.typeOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),e("div",{staticClass:"textarea-container"},[e("p",[e("span",[t._v(t._s(t.sourceObj[t.typeValue]))])]),e("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:t.initialValue,callback:function(e){t.initialValue=e},expression:"initialValue"}})],1),e("div",{staticClass:"btns-box"},["txt"===t.typeValue?e("el-button",{attrs:{size:"small"},on:{click:t.handleFormatTXTToM3u8}},[t._v("格式转换")]):"m3u8"===t.typeValue?e("el-button",{attrs:{size:"small"},on:{click:t.handleFormatM3u8ToTXT}},[t._v("格式转换")]):"txt转json"===t.typeValue?e("el-button",{attrs:{size:"small"},on:{click:t.handleFormatTxtToJson}},[t._v("格式转换")]):"m3u8转json"===t.typeValue?e("el-button",{attrs:{size:"small"},on:{click:t.handleFormatM3u8ToJson}},[t._v("格式转换")]):t._e(),e("el-button",{attrs:{size:"small"},on:{click:t.handleClear}},[t._v("清空屏幕")]),e("el-button",{attrs:{size:"small"},on:{click:t.handleCopyResult}},[t._v("拷贝结果")]),e("el-button",{attrs:{size:"small"},on:{click:t.handleDownload}},[t._v("保存结果")]),e("el-dropdown",{attrs:{trigger:"click"},on:{command:t.downloadDemo},scopedSlots:t._u([{key:"dropdown",fn:function(){return[e("el-dropdown-menu",[e("el-dropdown-item",{attrs:{command:"templateTxt"}},[t._v("txt格式模板")]),e("el-dropdown-item",{attrs:{command:"templateM3u8"}},[t._v("m3u8模板")])],1)]},proxy:!0}])},[e("el-button",{attrs:{size:"small"}},[t._v("下载模板")])],1)],1),e("div",{staticClass:"textarea-container"},[e("p",[e("span",[t._v(t._s(t.resultObj[t.typeValue]))])]),e("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:t.resultValue,callback:function(e){t.resultValue=e},expression:"resultValue"}})],1)],1)},i=[],s=(l(44114),l(18111),l(61701),l(14603),l(47566),l(98721),l(4901)),a={name:"index",components:{},data(){return{initialValue:"",resultValue:"",typeValue:"txt",ul:"",templateM3u8:"/yian/static/template/demo.m3u8",templateTxt:"/yian/static/template/demo.txt",sourceObj:{txt:"txt格式源",m3u8:"m3u8格式源","txt转json":"txt格式源","m3u8转json":"m3u8格式源"},resultObj:{txt:"m3u8格式转换结果",m3u8:"txt格式转换结果","txt转json":"json格式结果","m3u8转json":"json格式结果"},typeOptions:[{value:"txt",label:"txt转m3u8格式"},{value:"m3u8",label:"m3u8转txt格式"},{value:"txt转json",label:"txt转json格式"},{value:"m3u8转json",label:"m3u8转json格式"}]}},mounted(){},methods:{handleFormatM3u8ToTXT(){if(!this.initialValue)return this.$message.error("请先填写m3u8格式源"),!1;if(this.initialValue.includes("#genre#"))return this.$message.error("m3u8格式源错误"),!1;const t=this.initialValue.split("\n");let e=null,l=null,n=null,i="";for(const s of t){const t=s.trim();if(""!==t)if(t.includes("group-title")){const l=t.lastIndexOf('group-title="'),i=t.lastIndexOf('",');e=t.slice(l,i).replace(/group-title="/,"").trim(),n=t.slice(i,t.length).replace(/",/,"").trim()}else if(!t.includes("#EXTM3U")){let s=",#genre#",a="";l!==e?(l=e,s=`${e},#genre#`,a=`${s}\n${n},${t}`):a=`${n},${t}`,i+=`${a}\n`}}this.resultValue=i},handleFormatTXTToM3u8(){if(!this.initialValue)return this.$message.error("请先填写TXT格式源"),!1;if(this.initialValue.includes("#EXTINF")||this.initialValue.includes("#EXTM3U"))return this.$message.error("TXT格式源错误"),!1;const t=this.initialValue.split("\n");let e='#EXTM3U x-tvg-url="https://live.fanmingming.com/e.xml"\n',l=null;for(const n of t){const t=n.trim();if(""!==t)if(t.includes("#genre#"))l=t.replace(/,#genre#/,"").trim();else{const[n,i]=t.split(",").map((t=>t.trim())),s=n.replace(/(CCTV|CETV)-(\d+).*/,"$1$2");e+=`#EXTINF:-1 tvg-name="${s}" tvg-logo="https://live.fanmingming.com/tv/${s}.png"`,l&&(e+=` group-title="${l}"`),e+=`,${n}\n${i}\n`}}this.resultValue=e},handleFormatTxtToJson(){if(!this.initialValue)return this.$message.error("请先填写TXT格式源"),!1;if(this.initialValue.includes("#EXTINF")||this.initialValue.includes("#EXTM3U"))return this.$message.error("TXT格式源错误"),!1;const t=this.initialValue.split("\n"),e=[];for(const l of t){const t=l.trim();if(""!==t&&!t.includes("#genre#")){const[l,n]=t.split(",").map((t=>t.trim())),i=e.findIndex((t=>t.text===l));if(-1===i){const t={text:l,children:[{text:"源1",id:(0,s.$n)(),url:n}]};e.push(t)}else{const t=e[i].children.length,l={text:`源${t+1}`,id:(0,s.$n)(),url:n},a=e[i].children.findIndex((t=>t.url===n));-1===a&&e[i].children.push(l)}}}this.resultValue=JSON.stringify(e,"",2)},handleFormatM3u8ToJson(){if(!this.initialValue)return this.$message.error("请先填写m3u8格式源"),!1;if(this.initialValue.includes("#genre#"))return this.$message.error("m3u8格式源错误"),!1;const t=this.initialValue.split("\n");let e=null;const l=[];for(const n of t){const t=n.trim();if(""!==t)if(t.includes("group-title")){const l=t.lastIndexOf('",');e=t.slice(l,t.length).replace(/",/,"").trim()}else if(!t.includes("#EXTM3U")&&!t.includes("#EXTINF")){const n=l.findIndex((t=>t.text===e));if(-1===n){const n={text:e,children:[{text:"源1",id:(0,s.$n)(),url:t}]};l.push(n)}else{const e=l[n].children.length,i={text:`源${e+1}`,id:(0,s.$n)(),url:t},a=l[n].children.findIndex((e=>e.url===t));-1===a&&l[n].children.push(i)}}}this.resultValue=JSON.stringify(l,"",2)},handleClear(){this.initialValue="",this.resultValue=""},handleCopyResult(){if(!this.resultValue)return this.$message.error("请先转换再拷贝"),!1;(0,s.Dk)(this.resultValue)},handleDownload(){if(this.resultValue){const t=new Blob([this.resultValue],{type:"text/plain"}),e=document.createElement("a"),l=window.URL.createObjectURL(t);e.href=l;const n="txt"===this.typeValue?"m3u":"txt";e.download=`playlist.${n}`,document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(l)}else this.$message.error("内容为空，不可保存")},downloadDemo(t){console.log("command",t);const e=document.createElement("a");if(e.setAttribute("download",""),e.setAttribute("href",this[t]),document.all)e.click();else{const t=document.createEvent("MouseEvents");t.initEvent("click",!0,!0),e.dispatchEvent(t)}}}},u=a,o=l(81656),r=(0,o.A)(u,n,i,!1,null,"faa2e6b6",null),c=r.exports}}]);
//# sourceMappingURL=61.c2862ec5.js.map