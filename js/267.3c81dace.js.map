{"version":3,"file":"js/267.3c81dace.js","mappings":"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","sources":["webpack://yian/./src/views/pdfWatermark/index.vue?81b6","webpack://yian/./src/views/pdfWatermark/index.vue?08da","webpack://yian/./src/views/pdfWatermark/index.vue","webpack://yian/src/views/pdfWatermark/index.vue"],"sourcesContent":["import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=54834789&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=54834789&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"54834789\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"pdf-viewer\"},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"size\":\"small\",\"label-width\":\"80px\"}},[_c('el-row',{attrs:{\"type\":\"flex\",\"justify\":\"space-between\"}},[_c('el-col',{attrs:{\"span\":24}},[_c('el-form-item',[_c('input',{attrs:{\"type\":\"file\",\"accept\":\".pdf\"},on:{\"change\":_vm.onFileChange}})])],1)],1),_c('el-row',{attrs:{\"type\":\"flex\",\"justify\":\"space-around\",\"gutter\":20}},[_c('el-col',{attrs:{\"span\":6}},[_c('el-form-item',{attrs:{\"label\":\"水印内容\",\"prop\":\"watermarkText\",\"title\":_vm.form.watermarkText}},[_c('el-input',{attrs:{\"clearable\":\"\"},model:{value:(_vm.form.watermarkText),callback:function ($$v) {_vm.$set(_vm.form, \"watermarkText\", $$v)},expression:\"form.watermarkText\"}})],1)],1),_c('el-col',{attrs:{\"span\":6}},[_c('el-form-item',{attrs:{\"label\":\"字体\",\"prop\":\"fontFamily\"}},[_c('el-select',{attrs:{\"size\":\"small\",\"filterable\":\"\",\"placeholder\":\"请选择\"},model:{value:(_vm.form.fontFamily),callback:function ($$v) {_vm.$set(_vm.form, \"fontFamily\", $$v)},expression:\"form.fontFamily\"}},_vm._l((_vm.fontFamilyList),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1)],1)],1),_c('el-col',{attrs:{\"span\":6}},[_c('el-form-item',{attrs:{\"label\":\"字体大小\",\"prop\":\"fontSize\"}},[_c('el-input-number',{attrs:{\"min\":10,\"max\":100},model:{value:(_vm.form.fontSize),callback:function ($$v) {_vm.$set(_vm.form, \"fontSize\", $$v)},expression:\"form.fontSize\"}})],1)],1),_c('el-col',{attrs:{\"span\":6}},[_c('el-form-item',{attrs:{\"label\":\"透明度\",\"prop\":\"watermarkOpacity\"}},[_c('el-input-number',{attrs:{\"step\":0.1,\"min\":0,\"max\":1},model:{value:(_vm.form.watermarkOpacity),callback:function ($$v) {_vm.$set(_vm.form, \"watermarkOpacity\", $$v)},expression:\"form.watermarkOpacity\"}})],1)],1)],1),_c('el-row',{attrs:{\"type\":\"flex\",\"justify\":\"space-between\",\"gutter\":20}},[_c('el-col',{attrs:{\"span\":6}},[_c('el-form-item',{attrs:{\"label\":\"倾斜角度\",\"prop\":\"tiltAngle\"}},[_c('el-input-number',{attrs:{\"min\":-90,\"max\":90},model:{value:(_vm.form.tiltAngle),callback:function ($$v) {_vm.$set(_vm.form, \"tiltAngle\", $$v)},expression:\"form.tiltAngle\"}})],1)],1),_c('el-col',{attrs:{\"span\":6}},[_c('el-form-item',{attrs:{\"label\":\"间隔距离\",\"prop\":\"textSpacing\"}},[_c('el-input-number',{attrs:{\"step\":1,\"min\":100,\"max\":200},model:{value:(_vm.form.textSpacing),callback:function ($$v) {_vm.$set(_vm.form, \"textSpacing\", $$v)},expression:\"form.textSpacing\"}})],1)],1),_c('el-col',{attrs:{\"span\":6}},[_c('el-form-item',{attrs:{\"label\":\"字体颜色\",\"prop\":\"fontColor\"}},[_c('el-color-picker',{model:{value:(_vm.form.fontColor),callback:function ($$v) {_vm.$set(_vm.form, \"fontColor\", $$v)},expression:\"form.fontColor\"}})],1)],1),_c('el-col',{attrs:{\"span\":6}},[_c('el-form-item',[_c('el-button',{staticClass:\"download-btn\",attrs:{\"type\":\"primary\",\"loading\":_vm.loading},on:{\"click\":_vm.convertToPdfAndDownload}},[_vm._v(\" 下载 \")])],1)],1)],1)],1),(_vm.totalPages > 0)?_c('div',{staticClass:\"pdf-Box\"},[_vm._l((_vm.totalPages),function(_,index){return _c('canvas',{key:index,ref:\"pages\",refInFor:true})}),_c('el-backtop',{attrs:{\"target\":\".pdf-Box\"}})],2):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"pdf-viewer\" >\n    <el-form :model=\"form\" ref=\"form\" size=\"small\" label-width=\"80px\">\n      <el-row type=\"flex\" justify=\"space-between\">\n        <el-col :span=\"24\">\n          <el-form-item>\n            <input type=\"file\" accept=\".pdf\"  @change=\"onFileChange\">\n          </el-form-item>\n        </el-col>\n      </el-row>\n      <el-row  type=\"flex\" justify=\"space-around\" :gutter=\"20\">\n        <el-col :span=\"6\">\n          <el-form-item label=\"水印内容\" prop=\"watermarkText\" :title=\"form.watermarkText\">\n            <el-input v-model=\"form.watermarkText\" clearable></el-input>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"6\">\n          <el-form-item label=\"字体\" prop=\"fontFamily\">\n            <el-select size=\"small\" filterable v-model=\"form.fontFamily\" placeholder=\"请选择\">\n              <el-option\n                  v-for=\"item in fontFamilyList\"\n                  :key=\"item.value\"\n                  :label=\"item.label\"\n                  :value=\"item.value\">\n              </el-option>\n            </el-select>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"6\">\n          <el-form-item label=\"字体大小\" prop=\"fontSize\">\n            <el-input-number v-model=\"form.fontSize\" :min=\"10\" :max=\"100\"></el-input-number>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"6\">\n          <el-form-item label=\"透明度\" prop=\"watermarkOpacity\">\n            <el-input-number v-model=\"form.watermarkOpacity\" :step=\"0.1\" :min=\"0\" :max=\"1\"></el-input-number>\n          </el-form-item>\n        </el-col>\n<!--        <el-col :span=\"4\"></el-col>-->\n      </el-row>\n      <el-row type=\"flex\" justify=\"space-between\" :gutter=\"20\">\n        <el-col :span=\"6\">\n          <el-form-item label=\"倾斜角度\" prop=\"tiltAngle\">\n            <el-input-number v-model=\"form.tiltAngle\" :min=\"-90\" :max=\"90\"></el-input-number>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"6\">\n          <el-form-item label=\"间隔距离\" prop=\"textSpacing\">\n            <el-input-number v-model=\"form.textSpacing\" :step=\"1\" :min=\"100\" :max=\"200\"></el-input-number>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"6\">\n          <el-form-item label=\"字体颜色\" prop=\"fontColor\">\n            <el-color-picker v-model=\"form.fontColor\"></el-color-picker>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"6\">\n          <el-form-item>\n            <el-button\n                type=\"primary\"\n                class=\"download-btn\"\n                :loading=\"loading\"\n                @click=\"convertToPdfAndDownload\">\n              下载\n            </el-button>\n          </el-form-item>\n        </el-col>\n<!--        <el-col :span=\"4\"></el-col>-->\n<!--        <el-col :span=\"4\"></el-col>-->\n      </el-row>\n    </el-form>\n    <div class=\"pdf-Box\" v-if=\"totalPages > 0\">\n      <canvas  v-for=\"(_, index) in totalPages\" :key=\"index\" ref=\"pages\"></canvas>\n      <el-backtop target=\".pdf-Box\"></el-backtop>\n    </div>\n  </div>\n</template>\n\n<script>\nimport JsPDF from 'jspdf';\nimport * as pdfjsLib from 'pdfjs-dist';\nimport 'pdfjs-dist/build/pdf.worker.min';\n\nexport default {\n  data () {\n    return {\n      loading: false,\n      selectedFile: null,\n      pdfDocument: null,\n      arrayBuffer: null,\n      totalPages: 0,\n      fileName: '',\n      fontFamilyList: [\n        {\n          value: 'Arial',\n          label: 'Arial'\n        },\n        {\n          value: '宋体',\n          label: '宋体'\n        },\n        {\n          value: '楷体',\n          label: '楷体'\n        },\n        {\n          value: '仿宋',\n          label: '仿宋'\n        },\n        {\n          value: '黑体',\n          label: '黑体'\n        },\n        {\n          value: '等线',\n          label: '等线'\n        },\n        {\n          value: '微软雅黑',\n          label: '微软雅黑'\n        },\n        {\n          value: '思源黑体',\n          label: '思源黑体'\n        },\n        {\n          value: 'Times New Roman',\n          label: 'Times New Roman'\n        },\n        {\n          value: 'Helvetica Neue',\n          label: 'Helvetica Neue'\n        },\n        {\n          value: 'Helvetica',\n          label: 'Helvetica'\n        },\n        {\n          value: 'PingFang SC',\n          label: 'PingFang SC'\n        },\n        {\n          value: 'Hiragino Sans GB',\n          label: 'Hiragino Sans GB'\n        },\n        {\n          value: 'Microsoft YaHei',\n          label: 'Microsoft YaHei'\n        },\n        {\n          value: 'sans-serif',\n          label: 'sans-serif'\n        }\n      ],\n      form: {\n        watermarkText: 'Watermark',\n        tiltAngle: -30,\n        fontFamily: 'Arial',\n        watermarkOpacity: 0.5,\n        fontSize: 20,\n        textSpacing: 150,\n        fontColor: '#D02424'\n      }\n    };\n  },\n  watch: {\n    form: {\n      handler (newVal, oldVal) {\n        if (this.selectedFile) {\n          this.resetWatermark(this.selectedFile);\n        }\n      },\n      deep: true // 深度监听form对象的变化\n    }\n  },\n  async mounted () {\n    // await this.loadPDF();\n  },\n  methods: {\n    /**\n     * @Description 选择文件后触发\n     * @author qianyinggenian\n     * @date 2024/3/18\n     */\n    async onFileChange (event) {\n      const file = event.target.files[0];\n      if (!file || file.type !== 'application/pdf') {\n        this.$message.error('请选择PDF文件！');\n        return;\n      }\n      this.fileName = file.name || '水印文档.pdf';\n      this.selectedFile = file;\n      if (this.selectedFile) {\n        await this.resetWatermark(file);\n      }\n    },\n    /**\n     * @Description 重置水印\n     * @author qianyinggenian\n     * @date 2024/3/19\n     */\n    async resetWatermark (file) {\n      const arrayBuffer = await this.readFileAsArrayBuffer(file);\n      if (this.selectedFile) {\n        await this.loadPDF(arrayBuffer);\n      }\n    },\n    /**\n     * @Description 读取文件为ArrayBuffer\n     * @author qianyinggenian\n     * @date 2024/3/18\n     */\n    readFileAsArrayBuffer (file) {\n      return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onloadend = () => {\n          if (reader.result instanceof ArrayBuffer) {\n            resolve(reader.result);\n          } else {\n            reject(new Error('Failed to read the file as ArrayBuffer'));\n          }\n        };\n        reader.onerror = reject;\n        reader.readAsArrayBuffer(file);\n      });\n    },\n    async loadPDF (data) {\n      const loadingTask = pdfjsLib.getDocument({ data });\n      this.pdfDocument = await loadingTask.promise;\n      this.totalPages = this.pdfDocument.numPages;\n      if (this.pdfDocument && this.totalPages > 0) {\n        this.$nextTick(() => {\n          this.renderAllPages();\n        });\n      }\n    },\n    /**\n     * @Description 渲染\n     * @author qianyinggenian\n     * @date 2024/3/18\n     */\n    async renderAllPages () {\n      for (let pageNum = 1; pageNum <= this.totalPages; pageNum++) {\n        this.$nextTick(async () => {\n          const canvas = this.$refs.pages[pageNum - 1];\n          if (!canvas) {\n            console.error(`Canvas element for page ${pageNum} not found.`);\n            return false;\n          }\n          const page = await this.pdfDocument.getPage(pageNum);\n          const viewport = page.getViewport({ scale: 2 });\n          canvas.width = viewport.width;\n          canvas.height = viewport.height;\n          const context = canvas.getContext('2d');\n          context.clearRect(0, 0, canvas.width, canvas.height); // 清除canvas上的所有内容\n          const renderContext = {\n            canvasContext: context,\n            viewport\n          };\n\n          await page.render(renderContext).promise;\n          this.drawWatermark(context, pageNum, canvas);\n        });\n      }\n    },\n    /**\n     * @Description 添加水印\n     * @author qianyinggenian\n     * @date 2024/3/18\n     */\n    drawWatermark (context, pageNumber, canvas) {\n      const {\n        watermarkText,\n        tiltAngle,\n        fontSize,\n        fontColor,\n        watermarkOpacity,\n        fontFamily,\n        textSpacing\n      } = this.form;\n      // const textSpacing = 150; // 水印之间的间距\n      const num = Math.max(canvas.width, canvas.height);\n      const numWatermarks = Math.ceil(num / textSpacing);\n\n      for (let i = 0; i < numWatermarks; i++) {\n        for (let j = 0; j < numWatermarks; j++) {\n          const x = j * textSpacing;\n          const y = i * textSpacing;\n          context.save();\n          context.translate(x, y);\n          context.rotate((tiltAngle * Math.PI) / 180);\n          context.font = `bold ${fontSize}px ${fontFamily}`;\n          context.fillStyle = fontColor;\n          context.globalAlpha = watermarkOpacity;\n          context.fillText(`${watermarkText}`, 0, fontSize);\n          context.restore();\n        }\n      }\n    },\n    /**\n     * @Description 下载pdf\n     * @author qianyinggenian\n     * @date 2024/3/18\n     */\n    async downloadPDF () {\n      if (this.selectedFile) {\n        const doc = new JsPDF('p', 'mm', 'a4'); // 设置为纵向、毫米单位、A4纸张\n\n        const canvases = this.$refs.pages; // 示例中包含两个canvas\n\n        for (let i = 0; i < canvases.length; i++) {\n          const canvas = canvases[i];\n          const canvasElement = canvas.getContext('2d').canvas; // 获取canvas DOM元素\n\n          // 计算canvas在PDF页面上的居中坐标\n          // const canvasWidth = canvasElement.width;\n          // const canvasHeight = canvasElement.height;\n          const pdfWidth = doc.internal.pageSize.getWidth();\n          const pdfHeight = doc.internal.pageSize.getHeight();\n\n          // 将canvas转换为data URL\n          const dataUrl = canvasElement.toDataURL();\n\n          // 将data URL转换为image\n          const img = new Image();\n          img.src = dataUrl;\n          await new Promise((resolve) => {\n            img.onload = () => resolve();\n          });\n\n          // 添加图像至PDF，并居中显示\n          // doc.addImage(img, 'PNG', centerX, centerY, canvasWidth, canvasHeight);\n          doc.addImage(img, 'PNG', 0, 0, pdfWidth, pdfHeight);\n\n          // 如果有更多canvas且不是最后一张，则增加新页\n          if (i !== canvases.length - 1) {\n            doc.addPage();\n          }\n        }\n\n        // 生成并下载PDF文件\n        // doc.save(`${this.fileName}.pdf`);\n        doc.save(`水印-${this.fileName}`);\n      } else {\n        this.$message.error('请选择PDF文件！');\n      }\n    },\n    /**\n     * @Description 下载pdf\n     * @author qianyinggenian\n     * @date 2024/3/18\n     */\n    async convertToPdfAndDownload () {\n      if (this.selectedFile) {\n        this.$message.success('开始下载');\n        this.loading = true;\n        const pdf = new JsPDF('p', 'mm', 'a4'); // 初始化PDF文档\n\n        // 遍历所有的canvas元素\n        const canvases = this.$refs.pages; // 示例列表，根据实际情况替换为你的canvas refs\n        for (let i = 0; i < canvases.length; i++) {\n          const canvasRef = canvases[i];\n          // 将canvas转换为图像数据\n          const canvasImgData = canvasRef.toDataURL('image/jpeg', 1.0);\n          // const canvasImgData = canvas.toDataURL('image/jpeg');\n\n          // 将图像数据转换为PDF可用的图像\n          const img = await this.loadImage(canvasImgData);\n          // 获取canvas的实际大小\n          // const canvasWidth = canvas.clientWidth;\n          // const canvasHeight = canvas.clientHeight;\n          // console.log(canvasWidth, canvasWidth);\n          // console.log(canvasHeight, canvasHeight);\n          const pdfWidth = pdf.internal.pageSize.getWidth();\n          const pdfHeight = pdf.internal.pageSize.getHeight();\n          // 添加图像到PDF文档\n          // pdf.addImage(img, 'JPEG', 15, 40, canvasWidth, canvasHeight); // 调整坐标和尺寸以适应你的布局\n          pdf.addImage(img, 'JPEG', 0, 0, pdfWidth, pdfHeight); // 调整坐标和尺寸以适应你的布局\n\n          // 添加页面分隔（如果需要在每个canvas后换页）\n          // 如果有更多canvas且不是最后一张，则增加新页\n          if (i !== canvases.length - 1) {\n            pdf.addPage();\n          }\n        }\n\n        // 生成并下载PDF文件\n        // pdf.save(`${this.fileName}.pdf`);\n        this.$message.success('完成');\n        this.loading = false;\n        pdf.save(`水印-${this.fileName}`);\n      } else {\n        this.$message.error('请选择PDF文件！');\n      }\n    },\n    loadImage (dataUrl) {\n      return new Promise((resolve, reject) => {\n        const img = new Image();\n        img.src = dataUrl;\n        img.onload = () => resolve(img);\n        img.onerror = reject;\n      });\n    }\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n.pdf-viewer {\n  width: 100%;\n  height: 100%;\n  padding: 10px;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  canvas {\n    width: calc(100% - 10px);\n    margin: 0 5px 10px 5px;\n  }\n  .el-form {\n    border: 1px solid #409EFF;\n    padding: 10px;\n    box-sizing: border-box;\n  }\n  .pdf-Box {\n    height: calc(100% - 190px);\n    margin-top: 5px;\n    border: 1px solid red;\n    padding: 5px;\n    box-sizing: border-box;\n    overflow-y: auto;\n  }\n}\n::v-deep .el-input-number__increase {\n  background: #153552 !important;\n  border-left: 1px solid #409eff !important;\n}\n::v-deep .el-input-number__decrease {\n  background: #153552 !important;\n  border-right: 1px solid #409eff !important;\n}\n\n::v-deep .el-color-picker__trigger {\n  border: 1px solid #409eff !important;\n}\n.download-btn {\n  width: 80px;\n}\n::v-deep .el-icon-loading {\n  font-size: 14px !important;\n}\n</style>\n"],"names":["component","render","_vm","this","_c","_self","staticClass","ref","attrs","form","on","onFileChange","watermarkText","model","value","callback","$$v","$set","expression","fontFamily","_l","fontFamilyList","item","key","label","fontSize","watermarkOpacity","tiltAngle","textSpacing","fontColor","loading","convertToPdfAndDownload","_v","totalPages","_","index","refInFor","_e","staticRenderFns","data","selectedFile","pdfDocument","arrayBuffer","fileName","watch","handler","newVal","oldVal","resetWatermark","deep","mounted","methods","event","file","target","files","type","name","$message","error","readFileAsArrayBuffer","loadPDF","Promise","resolve","reject","reader","FileReader","onloadend","result","ArrayBuffer","Error","onerror","readAsArrayBuffer","loadingTask","pdfjsLib","promise","numPages","$nextTick","renderAllPages","pageNum","canvas","$refs","pages","console","page","getPage","viewport","getViewport","scale","width","height","context","getContext","clearRect","renderContext","canvasContext","drawWatermark","pageNumber","num","Math","max","numWatermarks","ceil","i","j","x","y","save","translate","rotate","PI","font","fillStyle","globalAlpha","fillText","restore","downloadPDF","doc","JsPDF","canvases","length","canvasElement","pdfWidth","internal","pageSize","getWidth","pdfHeight","getHeight","dataUrl","toDataURL","img","Image","src","onload","addImage","addPage","success","pdf","canvasRef","canvasImgData","loadImage"],"sourceRoot":""}