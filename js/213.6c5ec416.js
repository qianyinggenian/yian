"use strict";(self["webpackChunkyian"]=self["webpackChunkyian"]||[]).push([[213],{36213:function(e,t,i){i.r(t),i.d(t,{default:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"video-watermark-container"},[t("div",{staticClass:"top"},[t("button",{on:{click:e.startRecording}},[e._v("开始录制带水印的视频")]),t("a",{ref:"downloadLink",staticStyle:{display:"none"}})]),t("div",{staticClass:"bottom"},[t("video",{ref:"videoElement",attrs:{src:i(8983),crossorigin:"anonymous",controls:""},on:{canplay:e.onVideoCanPlay,pause:e.onVideoPause,ended:e.onVideoEnded}}),t("canvas",{ref:"canvasElement",staticClass:"watermarked-video"})])])},s=[],n=(i(44114),i(14603),i(47566),i(98721),{props:{},data(){return{videoContext:null,canvasContext:null,watermarkImage:null,isPlaying:!1}},mounted(){},methods:{onVideoCanPlay(){this.isPlaying=!0,this.setupCanvas(),this.drawFrame(),this.$nextTick((()=>{this.setupRecorder()}))},onVideoPause(){this.isPlaying=!1},onVideoEnded(){this.isPlaying=!1},setupCanvas(){const e=this.$refs.canvasElement;e.width=this.$refs.videoElement.videoWidth,e.height=this.$refs.videoElement.videoHeight,console.log("canvas.width",e.width),console.log("canvas.height",e.height),this.canvasContext=e.getContext("2d")},drawFrame(){if(!this.isPlaying)return;this.canvasContext.drawImage(this.$refs.videoElement,0,0,this.$refs.canvasElement.width,this.$refs.canvasElement.height),this.canvasContext.font="30px Arial",this.canvasContext.fillStyle="#ffffff",this.canvasContext.globalAlpha=.3;const e="Sample Watermark",t=this.canvasContext.measureText(e).width,i=this.$refs.canvasElement.width-t-10,a=this.$refs.canvasElement.height-40;this.canvasContext.fillText(e,i,a),requestAnimationFrame(this.drawFrame)},startRecording(){this.mediaRecorder&&"inactive"===this.mediaRecorder.state?(this.recordedChunks=[],this.mediaRecorder.start(),console.log("Recording started")):console.error("MediaRecorder is not initialized or is in an invalid state.")},stopRecording(){this.mediaRecorder&&"inactive"!==this.mediaRecorder.state?(this.mediaRecorder.stop(),console.log("Recording stopped")):console.error("Recording was not in progress.")},async downloadRecordedVideo(){const e=new Blob(this.recordedChunks,{type:"video/webm"}),t=URL.createObjectURL(e);this.$refs.downloadLink.href=t,this.$refs.downloadLink.download="watermarked_video.webm",this.$refs.downloadLink.click(),URL.revokeObjectURL(t)},setupRecorder(){const e=this.$refs.canvasElement.captureStream();this.mediaRecorder=new MediaRecorder(e,{mimeType:"video/webm"}),this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&this.recordedChunks.push(e.data)},this.mediaRecorder.onstop=()=>{this.downloadRecordedVideo()}}}}),o=n,r=i(81656),d=(0,r.A)(o,a,s,!1,null,"3ba4a135",null),c=d.exports},8983:function(e,t,i){e.exports=i.p+"media/shanghai.35d81ab9.mp4"}}]);
//# sourceMappingURL=213.6c5ec416.js.map