"use strict";(self["webpackChunkyian"]=self["webpackChunkyian"]||[]).push([[518],{24518:function(e,t,l){l.r(t),l.d(t,{default:function(){return c}});var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.handleClear},model:{value:e.typeValue,callback:function(t){e.typeValue=t},expression:"typeValue"}},e._l(e.typeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("div",{staticClass:"textarea-container"},[t("p",[t("span",[e._v(e._s(e.sourceObj[e.typeValue]))])]),t("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.initialValue,callback:function(t){e.initialValue=t},expression:"initialValue"}})],1),t("div",{staticClass:"btns-box"},["txt"===e.typeValue?t("el-button",{attrs:{size:"small"},on:{click:e.handleFormatTXTToM3u8}},[e._v("格式转换")]):"m3u8"===e.typeValue?t("el-button",{attrs:{size:"small"},on:{click:e.handleFormatM3u8ToTXT}},[e._v("格式转换")]):"txt转json"===e.typeValue?t("el-button",{attrs:{size:"small"},on:{click:e.handleFormatTxtToJson}},[e._v("格式转换")]):"m3u8转json"===e.typeValue?t("el-button",{attrs:{size:"small"},on:{click:e.handleFormatM3u8ToJson}},[e._v("格式转换")]):e._e(),t("el-button",{attrs:{size:"small"},on:{click:e.handleClear}},[e._v("清空屏幕")]),t("el-button",{attrs:{size:"small"},on:{click:e.handleCopyResult}},[e._v("拷贝结果")]),t("el-button",{attrs:{size:"small"},on:{click:e.handleDownload}},[e._v("保存结果")]),t("el-dropdown",{attrs:{trigger:"click"},on:{command:e.downloadDemo},scopedSlots:e._u([{key:"dropdown",fn:function(){return[t("el-dropdown-menu",[t("el-dropdown-item",{attrs:{command:"templateTxt"}},[e._v("txt格式模板")]),t("el-dropdown-item",{attrs:{command:"templateM3u8"}},[e._v("m3u8模板")])],1)]},proxy:!0}])},[t("el-button",{attrs:{size:"small"}},[e._v("下载模板")])],1)],1),t("div",{staticClass:"textarea-container"},[t("p",[t("span",[e._v(e._s(e.resultObj[e.typeValue]))])]),t("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.resultValue,callback:function(t){e.resultValue=t},expression:"resultValue"}})],1)],1)},i=[],s=(l(44114),l(14603),l(47566),l(98721),l(4901)),a={name:"index",components:{},data(){return{initialValue:"",resultValue:"",typeValue:"txt",ul:"",templateM3u8:"/yian/static/template/demo.m3u8",templateTxt:"/yian/static/template/demo.txt",sourceObj:{txt:"txt格式源",m3u8:"m3u8格式源","txt转json":"txt格式源","m3u8转json":"m3u8格式源"},resultObj:{txt:"m3u8格式转换结果",m3u8:"txt格式转换结果","txt转json":"json格式结果","m3u8转json":"json格式结果"},typeOptions:[{value:"txt",label:"txt转m3u8格式"},{value:"m3u8",label:"m3u8转txt格式"},{value:"txt转json",label:"txt转json格式"},{value:"m3u8转json",label:"m3u8转json格式"}]}},mounted(){},methods:{handleFormatM3u8ToTXT(){if(!this.initialValue)return this.$message.error("请先填写m3u8格式源"),!1;if(this.initialValue.includes("#genre#"))return this.$message.error("m3u8格式源错误"),!1;const e=this.initialValue.split("\n");let t=null,l=null,n=null,i="";for(const s of e){const e=s.trim();if(""!==e)if(e.includes("group-title")){const l=e.lastIndexOf('group-title="'),i=e.lastIndexOf('",');t=e.slice(l,i).replace(/group-title="/,"").trim(),n=e.slice(i,e.length).replace(/",/,"").trim()}else if(!e.includes("#EXTM3U")){let s=",#genre#",a="";l!==t?(l=t,s=`${t},#genre#`,a=`${s}\n${n},${e}`):a=`${n},${e}`,i+=`${a}\n`}}this.resultValue=i},handleFormatTXTToM3u8(){if(!this.initialValue)return this.$message.error("请先填写TXT格式源"),!1;if(this.initialValue.includes("#EXTINF")||this.initialValue.includes("#EXTM3U"))return this.$message.error("TXT格式源错误"),!1;const e=this.initialValue.split("\n");let t='#EXTM3U x-tvg-url="https://live.fanmingming.com/e.xml"\n',l=null;for(const n of e){const e=n.trim();if(""!==e)if(e.includes("#genre#"))l=e.replace(/,#genre#/,"").trim();else{const[n,i]=e.split(",").map((e=>e.trim())),s=n.replace(/(CCTV|CETV)-(\d+).*/,"$1$2");t+=`#EXTINF:-1 tvg-name="${s}" tvg-logo="https://live.fanmingming.com/tv/${s}.png"`,l&&(t+=` group-title="${l}"`),t+=`,${n}\n${i}\n`}}this.resultValue=t},handleFormatTxtToJson(){if(!this.initialValue)return this.$message.error("请先填写TXT格式源"),!1;if(this.initialValue.includes("#EXTINF")||this.initialValue.includes("#EXTM3U"))return this.$message.error("TXT格式源错误"),!1;const e=this.initialValue.split("\n"),t=[];for(const l of e){const e=l.trim();if(""!==e&&!e.includes("#genre#")){const[l,n]=e.split(",").map((e=>e.trim())),i=t.findIndex((e=>e.text===l));if(-1===i){const e={text:l,children:[{text:"源1",id:(0,s.$n)(),url:n}]};t.push(e)}else{const e=t[i].children.length,l={text:`源${e+1}`,id:(0,s.$n)(),url:n},a=t[i].children.findIndex((e=>e.url===n));-1===a&&t[i].children.push(l)}}}this.resultValue=JSON.stringify(t,"",2)},handleFormatM3u8ToJson(){if(!this.initialValue)return this.$message.error("请先填写m3u8格式源"),!1;if(this.initialValue.includes("#genre#"))return this.$message.error("m3u8格式源错误"),!1;const e=this.initialValue.split("\n");let t=null;const l=[];for(const n of e){const e=n.trim();if(""!==e)if(e.includes("group-title")){const l=e.lastIndexOf('",');t=e.slice(l,e.length).replace(/",/,"").trim()}else if(!e.includes("#EXTM3U")&&!e.includes("#EXTINF")){const n=l.findIndex((e=>e.text===t));if(-1===n){const n={text:t,children:[{text:"源1",id:(0,s.$n)(),url:e}]};l.push(n)}else{const t=l[n].children.length,i={text:`源${t+1}`,id:(0,s.$n)(),url:e},a=l[n].children.findIndex((t=>t.url===e));-1===a&&l[n].children.push(i)}}}this.resultValue=JSON.stringify(l,"",2)},handleClear(){this.initialValue="",this.resultValue=""},handleCopyResult(){if(!this.resultValue)return this.$message.error("请先转换再拷贝"),!1;navigator.clipboard.writeText(this.resultValue).then((()=>{this.$message.success("复制成功")}))},handleDownload(){if(this.resultValue){const e=new Blob([this.resultValue],{type:"text/plain"}),t=document.createElement("a"),l=window.URL.createObjectURL(e);t.href=l;const n="txt"===this.typeValue?"m3u":"txt";t.download=`playlist.${n}`,document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(l)}else this.$message.error("内容为空，不可保存")},downloadDemo(e){console.log("command",e);const t=document.createElement("a");if(t.setAttribute("download",""),t.setAttribute("href",this[e]),document.all)t.click();else{const e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0),t.dispatchEvent(e)}}}},o=a,r=l(81656),u=(0,r.A)(o,n,i,!1,null,"be4e4b1a",null),c=u.exports}}]);
//# sourceMappingURL=518.277d68fd.js.map