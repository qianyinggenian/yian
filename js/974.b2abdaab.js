"use strict";(self["webpackChunkyian"]=self["webpackChunkyian"]||[]).push([[974],{3972:function(e,t,s){s.d(t,{A:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("el-select",e._g(e._b({attrs:{title:e.selectTitle},scopedSlots:e._u([{key:"prefix",fn:function(){return[e._t("prefix")]},proxy:!0},{key:"empty",fn:function(){return[e._t("empty")]},proxy:!0}],null,!0),model:{value:e.selectValue,callback:function(t){e.selectValue=t},expression:"selectValue"}},"el-select",e.$attrs,!1),e.$listeners),[e._t("default"),e._l(e.options,(function(s){return t("el-option",{key:s[e.keyValue],attrs:{label:s[e.keyLabel],value:s[e.keyValue]}})}))],2)},r=[],l=(s(44114),{name:"index",data(){return{selectTitle:"",selectValue:null}},props:{value:{type:[String,Array]},keyValue:{type:String,default:"value"},keyLabel:{type:String,default:"label"},options:{type:Array,default:()=>[]}},watch:{value:{handler(e){this.selectValue=e},immediate:!0},selectValue:{handler(e){if(e&&e.length)if("string"===typeof e){const t=this.options.find((t=>t[this.keyValue]===e));this.selectTitle=t?t[this.keyLabel]:""}else this.getArrTitle();else this.selectTitle=""},immediate:!0}},methods:{getArrTitle(){const e=JSON.parse(JSON.stringify(this.options)),t=[];this.selectValue.forEach((s=>{for(const a of e)s===a[this.keyValue]&&t.push(a)})),this.selectTitle=t.map((e=>e[this.keyLabel])).toString()}}}),o=l,i=s(81656),n=(0,i.A)(o,a,r,!1,null,"63739d18",null),d=n.exports},34612:function(e,t,s){s.r(t),s.d(t,{default:function(){return L}});var a=function(){var e=this,t=e._self._c;return t("layout",{attrs:{"is-show-left":!1}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{slot:"right","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(10, 38, 63,0.6)","element-loading-custom-class":"loading-icon"},slot:"right"},[t("proxy-table",{ref:"proxyTable",attrs:{operations:e.operations,columns:e.columns,operationWidth:"200px","table-btns":e.tableBtns,"table-data":e.tableData,"diy-has-check-box":e.diyHasCheckBox},on:{add:e.handleAdd,edit:e.handleEdit,show:e.handleShow,remove:e.handleRemove,delete:e.handleDelete,select:e.handleSelect}}),e.isShowAddEdit?t("add-edit",{ref:"addEdit",on:{close:e.closeFn}}):e._e()],1)])},r=[],l=s(14518),o=function(){var e=this,t=e._self._c;return t("proxy-dialog",{ref:"dialog",attrs:{visible:e.isShowDialog,"is-show-footer":"show"!==e.type},on:{"update:visible":function(t){e.isShowDialog=t},close:e.handleClose}},[t("div",{staticClass:"dialog-form"},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,size:"small","label-width":"auto"}},[t("el-row",{attrs:{type:"flex",justify:"space-around",gutter:50}},[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"姓名",prop:"name",title:e.ruleForm.name}},[t("el-input",{attrs:{disabled:e.disabled,clearable:"",placeholder:"请输入"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1)],1),t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"账号",prop:"account",title:e.ruleForm.account}},[t("el-input",{attrs:{disabled:e.disabled,clearable:"",placeholder:"请输入"},model:{value:e.ruleForm.account,callback:function(t){e.$set(e.ruleForm,"account",t)},expression:"ruleForm.account"}})],1)],1)],1),t("el-row",{attrs:{type:"flex",justify:"space-around",gutter:50}},[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{autocomplete:"new-password",type:"password","show-password":"",disabled:e.disabled,clearable:"",placeholder:"请输入"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1)],1),t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[t("el-input",{attrs:{type:"password",autocomplete:"new-password",disabled:e.disabled,clearable:"",placeholder:"请输入","show-password":""},model:{value:e.ruleForm.confirmPassword,callback:function(t){e.$set(e.ruleForm,"confirmPassword",t)},expression:"ruleForm.confirmPassword"}})],1)],1)],1),t("el-row",{attrs:{type:"flex",justify:"space-around",gutter:50}},[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"状态",prop:"status"}},[t("proxySelect",{attrs:{disabled:e.disabled,options:e.accountStatusOptions,clearable:""},model:{value:e.ruleForm.status,callback:function(t){e.$set(e.ruleForm,"status",t)},expression:"ruleForm.status"}})],1)],1),t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"邮箱",prop:"email",title:e.ruleForm.email}},[t("el-input",{attrs:{disabled:e.disabled,clearable:"",placeholder:"请输入"},model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1)],1)],1),t("el-row",{attrs:{type:"flex",justify:"space-around",gutter:50}},[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"是否超管",prop:"isAdmin"}},[t("proxySelect",{attrs:{disabled:e.disabled,options:e.yesOrNo,clearable:""},model:{value:e.ruleForm.isAdmin,callback:function(t){e.$set(e.ruleForm,"isAdmin",t)},expression:"ruleForm.isAdmin"}})],1)],1),t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:"类型",prop:"type"}},[t("proxySelect",{attrs:{disabled:e.disabled,options:e.typeOptions,clearable:""},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}})],1)],1)],1)],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleSave}},[e._v("保存")])],1)])},i=[],n=s(74353),d=s.n(n),c=s(1315),u=s.n(c),p=s(95353),m=s(27421),h=s.n(m),f=s(63526),g=s(88604),y=s(3972),b=s(43172);const x=u().Random;var w={name:"add-edit",components:{proxyDialog:g.A,proxySelect:y.A},data(){return{encryptionKey:f.rs,decryptKey:f.$Q,type:"add",ruleForm:{isAdmin:""},rules:{name:[{required:!0,message:"请输入",trigger:"blur"}],account:[{required:!0,message:"请输入",trigger:"blur"}],password:[{required:!0,message:"请输入",trigger:"blur"}],confirmPassword:[{required:!0,message:"请输入",trigger:"blur"}],status:[{required:!0,message:"请选择",trigger:"change"}],isAdmin:[{required:!0,message:"请选择",trigger:"change"}],type:[{required:!0,message:"请选择",trigger:"change"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}]},typeOptions:b.xW,accountStatusOptions:b.uU,yesOrNo:b.GX,disabled:!1,isShowDialog:!1}},props:{},watch:{},computed:{...(0,p.L8)(["personalMsg"])},mounted(){},methods:{encrypt(e){const t=new(h());return t.setPublicKey(this.encryptionKey),t.encrypt(e)},decrypt(e){const t=new(h());return t.setPrivateKey(this.decryptKey),t.decrypt(e)},async getInfo(e){const{type:t,id:s}=e;if(console.log("Random.guid()",x.guid()),this.isShowDialog=!0,this.type=t,this.disabled="show"===t,"add"===t)return this.$set(this.ruleForm,"isAdmin","0"),this.$set(this.ruleForm,"status","启用"),!1;const a=await l.A.userDetail({id:s}),{code:r,data:o,msg:i}=a;if(200===r){this.ruleForm=o;const{confirmPassword:e,password:t}=this.ruleForm;this.ruleForm.password=t?this.decrypt(t):t,this.ruleForm.confirmPassword=e?this.decrypt(e):e}else this.$message.error(i)},handleClose(){this.isShowDialog=!1,this.$emit("close")},handleSave(){try{this.$refs.ruleForm.validate((async e=>{if(e){let e={};const{confirmPassword:t,password:s}=this.ruleForm;e="add"===this.type?{...this.ruleForm,id:x.guid(),creatDate:d()().format("YYYY-MM-DD HH:mm:ss"),creator:this.personalMsg.username,password:this.encrypt(s),confirmPassword:this.encrypt(t)}:{...this.ruleForm,password:this.encrypt(s),confirmPassword:this.encrypt(t)};const a=await l.A["add"===this.type?"userSave":"userUpdate"](e),{code:r,msg:o}=a;200===r?(this.$message.success(o),this.$emit("close",!0)):this.$message.error(o)}}))}catch(e){console.log(e)}}}},v=w,F=s(81656),k=(0,F.A)(v,o,i,!1,null,"650313ce",null),$=k.exports,S=s(25567),A=s(4901),D={name:"index",components:{addEdit:$,proxyTable:S.A},data(){return{loading:!1,isShowAddEdit:!1,tableData:[],selections:[],tableBtns:[{label:"查看",value:"show"},{label:"编辑",value:"edit"},{label:"删除",value:"delete"}],operations:[{value:"add",label:"新增"},{value:"remove",label:"删除"}],columns:[{prop:"name",label:"姓名"},{prop:"account",label:"账号"},{prop:"type",label:"类型"},{prop:"email",label:"邮箱"},{prop:"status",label:"状态"},{prop:"creator",label:"创建者"},{prop:"creatDate",label:"创建时间"}]}},mounted(){this.$nextTick((()=>{this.getList()}))},methods:{async getList(){this.loading=!0;const e=await l.A.userList(),{code:t,data:s,msg:a}=e;200===t?(this.tableData=s.list||[],this.tableData.sort(A.jL)):this.$message.error(a),this.loading=!1},handleAdd(){this.isShowAddEdit=!0,this.$nextTick((()=>{this.$refs.addEdit.getInfo({type:"add"})}))},handleEdit(e){this.handleDetail({type:"edit",id:e.id})},handleDetail(e){this.isShowAddEdit=!0,this.$nextTick((()=>{this.$refs.addEdit.getInfo(e)}))},handleShow(e){this.handleDetail({type:"show",id:e.id})},handleDelete(e){if("1"===e.isAdmin)return this.$message.info("该条数据不可删除"),!1;this.$confirm("确定删除该条数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{this.loading=!0;const t=await l.A.userDelete({id:e.id});200===t.code?(this.$message.success(t.msg),this.$nextTick((()=>{this.getList()}))):this.$message.error(t.msg),this.loading=!1})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},handleSelect(e){this.selections=e},diyHasCheckBox(e,t){return"1"!==e.isAdmin},handleRemove(){const e=this.selections.map((e=>e.id));if(0===e.length)return this.$message.error("请选择数据！"),!1;this.$confirm("确定删除所选数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{this.loading=!0;const t=await l.A.userBatchDelete({ids:e});200===t.code?(this.$message.success(t.msg),this.$nextTick((()=>{this.getList()}))):this.$message.error(t.msg),this.loading=!1})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},closeFn(e){this.isShowAddEdit=!1,e&&this.getList()}}},T=D,E=(0,F.A)(T,a,r,!1,null,"4a1a3a77",null),L=E.exports},43172:function(e,t,s){s.d(t,{GX:function(){return l},uU:function(){return r},xW:function(){return a}});const a=[{value:"超管",label:"超管",id:"EeFDC299-f42b-8cc7-1bfB-dF189C655661"},{value:"用户",label:"用户",id:"C82CB616-1173-2eA6-4dD1-b92EfF2406eb"},{value:"访客",label:"访客",id:"E59Dcfb1-0d6b-11C2-F884-6FC26e9815C3"}],r=[{value:"启用",label:"启用"},{value:"禁用",label:"禁用"}],l=[{value:"1",label:"是"},{value:"0",label:"否"}]},4901:function(e,t,s){s.d(t,{$n:function(){return l},PE:function(){return r},jL:function(){return a}});s(44114),s(14603),s(47566),s(98721);function a(e,t,s="creatDate"){return Date.parse(t[s])-Date.parse(e[s])}function r(e,t="新建文本文档",s="txt"){if(e){const a=new Blob([e],{type:"text/plain"}),r=document.createElement("a"),l=window.URL.createObjectURL(a);r.href=l,r.download=`${t}.${s}`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(l)}else this.$message.error("内容为空，不可保存")}function l(){let e=(new Date).getTime();const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const s=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?s:3&s|8).toString(16)}));return t}},36955:function(e,t,s){var a=s(92140),r=s(94901),l=s(44576),o=s(78227),i=o("toStringTag"),n=Object,d="Arguments"===l(function(){return arguments}()),c=function(e,t){try{return e[t]}catch(s){}};e.exports=a?l:function(e){var t,s,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(s=c(t=n(e),i))?s:d?l(t):"Object"===(a=l(t))&&r(t.callee)?"Arguments":a}},62106:function(e,t,s){var a=s(50283),r=s(24913);e.exports=function(e,t,s){return s.get&&a(s.get,t,{getter:!0}),s.set&&a(s.set,t,{setter:!0}),r.f(e,t,s)}},92140:function(e,t,s){var a=s(78227),r=a("toStringTag"),l={};l[r]="z",e.exports="[object z]"===String(l)},655:function(e,t,s){var a=s(36955),r=String;e.exports=function(e){if("Symbol"===a(e))throw new TypeError("Cannot convert a Symbol value to a string");return r(e)}},22812:function(e){var t=TypeError;e.exports=function(e,s){if(e<s)throw new t("Not enough arguments");return e}},14603:function(e,t,s){var a=s(36840),r=s(79504),l=s(655),o=s(22812),i=URLSearchParams,n=i.prototype,d=r(n.append),c=r(n["delete"]),u=r(n.forEach),p=r([].push),m=new i("a=1&a=2&b=3");m["delete"]("a",1),m["delete"]("b",void 0),m+""!=="a=2"&&a(n,"delete",(function(e){var t=arguments.length,s=t<2?void 0:arguments[1];if(t&&void 0===s)return c(this,e);var a=[];u(this,(function(e,t){p(a,{key:t,value:e})})),o(t,1);var r,i=l(e),n=l(s),m=0,h=0,f=!1,g=a.length;while(m<g)r=a[m++],f||r.key===i?(f=!0,c(this,r.key)):h++;while(h<g)r=a[h++],r.key===i&&r.value===n||d(this,r.key,r.value)}),{enumerable:!0,unsafe:!0})},47566:function(e,t,s){var a=s(36840),r=s(79504),l=s(655),o=s(22812),i=URLSearchParams,n=i.prototype,d=r(n.getAll),c=r(n.has),u=new i("a=1");!u.has("a",2)&&u.has("a",void 0)||a(n,"has",(function(e){var t=arguments.length,s=t<2?void 0:arguments[1];if(t&&void 0===s)return c(this,e);var a=d(this,e);o(t,1);var r=l(s),i=0;while(i<a.length)if(a[i++]===r)return!0;return!1}),{enumerable:!0,unsafe:!0})},98721:function(e,t,s){var a=s(43724),r=s(79504),l=s(62106),o=URLSearchParams.prototype,i=r(o.forEach);a&&!("size"in o)&&l(o,"size",{get:function(){var e=0;return i(this,(function(){e++})),e},configurable:!0,enumerable:!0})}}]);
//# sourceMappingURL=974.b2abdaab.js.map