"use strict";(self["webpackChunkyian"]=self["webpackChunkyian"]||[]).push([[255],{1255:function(t,e,a){a.r(e),a.d(e,{default:function(){return b}});var l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"waterMakerInfo"},[e("div",{staticClass:"content"},[e("div",{staticClass:"statement"},[t._v("责任声明：本功能不存储数据，仅用于学习研究，请勿用于商业用途，如用于其他用途造成的法律后果，由使用人自行承担。使用本功能，即认为你同意本责任声明。")]),t._m(0),e("div",{staticClass:"tool-bar"},[e("div",{staticClass:"file"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("请选择文件：")]),e("div",{staticClass:"value"},[e("input",{attrs:{id:"file",accept:"",type:"file"},on:{change:t.handleChangeFile}})])])]),e("div",{staticClass:"font-style"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label",on:{click:t.handleClick}},[t._v("水印文字：")]),t._l(t.watermarkObj.textArray,(function(a,l){return e("div",{key:l,staticClass:"value text"},[e("el-input",{attrs:{size:"small",clearable:"",title:a.text,placeholder:`请输入水印${l+1}内容`},on:{change:t.resetWatermark},model:{value:a.text,callback:function(e){t.$set(a,"text",e)},expression:"item.text"}})],1)})),e("div",[e("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.handleAdd}},[e("i",{staticClass:"el-icon-plus",staticStyle:{"font-size":"16px",color:"red"}}),t._v(" 新增 ")])],1)],2)]),e("div",{staticClass:"font-style"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("字体大小：")]),e("div",{staticClass:"value"},[e("el-select",{attrs:{size:"small",clearable:"",filterable:"",placeholder:"请选择"},on:{change:t.resetWatermark},model:{value:t.watermarkObj.fontSize,callback:function(e){t.$set(t.watermarkObj,"fontSize",e)},expression:"watermarkObj.fontSize"}},t._l(t.fontSizeList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("字体：")]),e("div",{staticClass:"value"},[e("el-select",{attrs:{size:"small",clearable:"",filterable:"",placeholder:"请选择"},on:{change:t.resetWatermark},model:{value:t.watermarkObj.fontFamily,callback:function(e){t.$set(t.watermarkObj,"fontFamily",e)},expression:"watermarkObj.fontFamily"}},t._l(t.fontFamilyList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("字体颜色：")]),e("div",{staticClass:"value"},[e("el-color-picker",{attrs:{size:"small"},on:{change:t.resetWatermark},model:{value:t.watermarkObj.fontcolor,callback:function(e){t.$set(t.watermarkObj,"fontcolor",e)},expression:"watermarkObj.fontcolor"}})],1)])]),e("div",{staticClass:"layout"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("方向：")]),e("div",{staticClass:"value"},[e("el-slider",{attrs:{min:-180,max:180},on:{change:t.resetWatermark},model:{value:t.watermarkObj.rotate,callback:function(e){t.$set(t.watermarkObj,"rotate",e)},expression:"watermarkObj.rotate"}})],1),e("div",{staticClass:"value1"},[t._v(t._s(t.watermarkObj.rotate)+"°")])]),e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("透明度：")]),e("div",{staticClass:"value"},[e("el-slider",{on:{change:t.resetWatermark},model:{value:t.watermarkObj.opacity,callback:function(e){t.$set(t.watermarkObj,"opacity",e)},expression:"watermarkObj.opacity"}})],1),e("div",{staticClass:"value1"},[t._v(t._s(t.watermarkObj.opacity)+"%")])]),e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("稠密度：")]),e("div",{staticClass:"value"},[e("el-slider",{attrs:{step:.1,min:.1,max:6},on:{change:t.resetWatermark},model:{value:t.watermarkObj.density,callback:function(e){t.$set(t.watermarkObj,"density",e)},expression:"watermarkObj.density"}})],1),e("div",{staticClass:"value1"},[t._v(t._s(t.watermarkObj.density))])]),t._e()])]),t.fileUrl?e("div",{staticClass:"imageBox",attrs:{id:"imageBox"}}):t._e(),e("div",{staticClass:"download-btn"},[e("el-button",{staticStyle:{"margin-top":"10px",width:"80px"},attrs:{type:"primary"},on:{click:t.downFile}},[t._v("下 载")])],1)])])},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"thanks"},[t._v("特别感谢："),e("a",{attrs:{href:"https://blog.csdn.net/qq_37831545/article/details/128846647",target:"_blank"}},[t._v("一朵野花压海棠")]),t._v(" 和 "),e("a",{attrs:{href:"https://blog.csdn.net/cuixiping/article/details/45932793",target:"_blank"}},[t._v("cuixiping")]),t._v(" 提供的分享 ")])}];a(44114),a(18111),a(7588),a(61701),a(64979);async function i(t){const e=document.createElement("img");e.src=t,e.setAttribute("crossOrigin","anonymous"),await new Promise((t=>e.onload=t));const a=document.createElement("canvas");return a.width=e.width,a.height=e.height,a.getContext("2d").drawImage(e,0,0),a}async function r(){const t="myImageId";if(null!==document.getElementById(t)){const e=document.getElementsByClassName("imageBox")[0];e&&e.contains(document.getElementById(t))?e.removeChild(document.getElementById(t)):document.body.removeChild(document.getElementById(t))}}const n=({canvas:t,textArray:e,fontFamily:a="microsoft yahei",fontSize:l,fontcolor:s="#dadbdc",rotate:i=30,textAlign:r="left",density:n=2,opacity:o=50})=>{const c=t.getContext("2d"),d=t.width,m=t.height;c.font=`${l}px ${a}`,c.lineWidth=1,c.fillStyle=s,c.textAlign=r,c.textBaseline="middle",c.globalAlpha=o/100;const v=Math.max(d,m),u=Math.floor(v/n),h=[0];while(h[h.length-1]<v/2)h.push(h[h.length-1]+u);h.push(...h.slice(1,h.length).map((t=>-t)));for(let b=0;b<h.length;b++)for(let t=0;t<h.length;t++)c.save(),c.translate(d/2,m/2),c.rotate(Math.PI/120*-i),e.length>3&&(e=e.slice(0,3)),e.forEach(((e,a)=>{const s=l*a+2;c.fillText(e.text,h[b],h[t]+s)})),c.restore()};function o({canvas:t,maxWidth:e="100%",maxHeight:a="100%"}){var l=new Image;return l.src=t.toDataURL("image/png"),l.style.maxHeight=a,l.style.maxWidth=e,l.setAttribute("id","myImageId"),l}function c(t,e="下载"){const a=t.toDataURL("image/png"),l=d(a),s=document.createElement("a"),i=window.URL.createObjectURL(l);s.href=i,s.download=e,s.click(),window.URL.revokeObjectURL(i)}function d(t){var e=t.split(","),a=e[0].match(/:(.*?);/)[1],l=atob(e[1]),s=l.length,i=new Uint8Array(s);while(s--)i[s]=l.charCodeAt(s);return new Blob([i],{type:a})}var m={data(){return{fileUrl:"",fontFamilyList:[{value:"宋体",label:"宋体"},{value:"楷体",label:"楷体"},{value:"仿宋",label:"仿宋"},{value:"黑体",label:"黑体"},{value:"等线",label:"等线"},{value:"微软雅黑",label:"微软雅黑"},{value:"思源黑体",label:"思源黑体"},{value:"Times New Roman",label:"Times New Roman"},{value:"Helvetica Neue",label:"Helvetica Neue"},{value:"Helvetica",label:"Helvetica"},{value:"PingFang SC",label:"PingFang SC"},{value:"Hiragino Sans GB",label:"Hiragino Sans GB"},{value:"Microsoft YaHei",label:"Microsoft YaHei"},{value:"Arial",label:"Arial"},{value:"sans-serif",label:"sans-serif"}],fontSizeList:[],watermarkObj:{fontcolor:"#000000",fontSize:64,opacity:50,position:1,fontFamily:"仿宋",canvas:null,rotate:30,density:3,textAlign:"center",textArray:[{text:"水印内容"}]},watermarkParams:{}}},mounted(){for(let t=12;t<=128;t++){const e={value:t,label:`${t}px`};this.fontSizeList.push(e)}},methods:{handleChangeFile(t){const e=t.target.files[0];console.log("文件名:",e.name),console.log("文件类型:",e.type);const a=new FileReader;a.onloadend=()=>{this.fileUrl=a.result,this.drawWaterMarkFn()},a.readAsDataURL(e)},resetWatermark(){this.fileUrl&&this.drawWaterMarkFn()},handleClick(){console.log(this.watermarkObj.textArray)},handleAdd(){const{textArray:t}=this.watermarkObj;t&&t.length<3?this.watermarkObj.textArray.push({text:""}):this.$message.error("水印内容最多三行")},async drawWaterMarkFn(){r();const t=await i(this.fileUrl);this.watermarkObj.canvas=t,n(this.watermarkObj);const e=await o({canvas:t,maxWidth:"650px",maxHeight:"650px"});var a=document.getElementById("imageBox");a.appendChild(e)},async downFile(){if(this.fileUrl){const t=await i(this.fileUrl);this.watermarkObj.canvas=t,await n(this.watermarkObj),c(t,"水印图片下载")}else this.$message.error("请上传图片后再下载")}}},v=m,u=a(81656),h=(0,u.A)(v,l,s,!1,null,"7da96d09",null),b=h.exports}}]);
//# sourceMappingURL=255.d1fdeb1c.js.map