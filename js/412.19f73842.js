"use strict";(self["webpackChunkyian"]=self["webpackChunkyian"]||[]).push([[412],{89412:function(e,s,l){l.r(s),l.d(s,{default:function(){return c}});var t=function(){var e=this,s=e._self._c;return s("div",[s("input",{attrs:{id:"file",accept:".xlsx, .xls",type:"file"},on:{change:e.handleChange}})])},i=[],o=(l(44114),l(24974)),n=l.n(o),a={name:"index",components:{},data(){return{}},props:{},watch:{},computed:{},mounted(){},methods:{handleChange(e){this.filePath=e.target.files[0].name,this.files=e.target.files,console.log("files",this.files),console.log("files[0]",this.files[0]);let s=!0;for(let l=0;l<this.files.length;l++){const e=this.files[l].name.split("."),t=e[e.length-1];["xls","xlsx"].includes(t)||(s=!1)}s||(this.$message.error("请选择正确文件类型(.xls，.xlsx)导入！"),this.$refs.file&&(this.filePath="",this.$refs.file.value="")),this.fileInfo(),this.validateExcelFile(this.files[0])},validateExcelFile(e){return new Promise(((s,l)=>{const t=new FileReader;t.readAsArrayBuffer(e),t.onload=()=>{const e=t.result,i=new(n().Workbook);i.xlsx.load(e).then((()=>{const e=i.getWorksheet(1),l=e.getRow(1).values;l.shift(),console.log("rowCount",l);const t=[];e.getSheetValues().filter((e=>!!e?.length)).forEach((e=>{e.shift();const s={};e.forEach(((e,t)=>{s[l[t]]=e})),t.push(s)})),t.shift(),console.log("excelList",t),s("Excel file is valid.")})).catch((e=>{l("Error occurred while loading the workbook.")}))}}))},async fileInfo(){const e=new(n().Workbook),s=await e.xlsx.load(this.files[0]);console.log("res",s)}}},r=a,h=l(81656),f=(0,h.A)(r,t,i,!1,null,"2ee53f0c",null),c=f.exports}}]);
//# sourceMappingURL=412.19f73842.js.map